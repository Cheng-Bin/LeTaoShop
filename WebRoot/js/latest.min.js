/*!
 * jquery.fn.dialog
 * @author 云淡然 http://qianduanblog.com
 * @for ie9(含)+、chrome、firefox
 * @require http://static.qianduanblog.com/js/jquery-dialog/css/default.css
 * @require drag.js
 * @version 1.4
 * 2013年11月25日15:03:06
 */
(function(i,h,j){var v,s="jquery-dialog____",g=0,a=[],b={},n=2000,u=74,m=/^auto$/i,q=/\d/,e=0,l={css:"http://static.qianduanblog.com/css/jquery-dialog/default.min.css?v="+Math.ceil(Date.now()/86400000),title:"Untitled",autoOpen:false,width:600,height:"auto",zIndex:2000,overflow:"scroll",duration:123,draggable:true,closeOnEsc:true,closeOnBg:true,canHide:true,url:"",onopen:function(){},onclose:function(){}};
i.fn.dialog=function(){var w=arguments,x=w.length;return this.each(function(){var F,J=i(this),z=s+Date.now(),C="<div style='position:absolute;' class='"+s+"' id='"+z+"'><div class='"+s+"wrap'><div class='"+s+"header'><span class='"+s+"title'></span><a class='"+s+"close' href='javascript:;'>&times;</a></div><div class='"+s+"body'></div></div></div>",H="<div class='"+s+"bg' id='"+z+"bg'></div>",B={},I,E,A,D,y;
if(o(J,"hasInit")===j){o(J,"hasInit",0);}if(o(J,"isOpen")===j){o(J,"isOpen",0);}D=o(J,"hasInit");y=o(J,"isOpen");if(w[0]==="open"){if(i.isPlainObject(w[1])){B=w[1];
}else{if(i.isPlainObject(w[2])){B=w[2];}}G(B,function(){if(i.isPlainObject(w[1])&&w[1].url!=""){J.empty();}d(J,i.isFunction(w[1])?w[1]:function(){if(i.isPlainObject(w[1])){k(J,w[1]);
if(i.isFunction(w[2])){w[2].call();}}});});}else{if(w[0]==="position"){G(B,function(){f(J);});}else{if(w[0]==="close"){G(B,function(){c(J);});}else{G(w[0]);
}}}function G(K,M){I=o(J,"options");if(D){k(J,I);if(I.autoOpen){d(J);}if(M){M();}}else{I=i.extend({},l,K);if(I.zIndex>n){n=I.zIndex;}o(J,"id",z);o(J,"options",I);
b[z]=J[0];if(!g){i('<link rel="stylesheet" href="'+I.css+'" />').appendTo("head").load(function(){g=1;L();}).error(function(){alert("jquery-dialog样式加载失败，请稍后再试！");
return;});}else{L();}function L(){var N=0;o(J,"hasInit",1);$bg=i(H).appendTo("body");A=i(C).appendTo("body");A.hide();J.show();A.on("click","."+s+"close",function(){c(J);
});k(J,I,J);if(i.fn.drag&&I.draggable){A.drag({handle:"."+s+"header"});}if(I.autoOpen){d(J);}if(M){M();}}}}});};i.fn.dialog.defaults=l;i(document).keyup(function(y){var w=p(),x={};
if(y.which==27&&w&&w.length){x=o(w,"options");if(x.canHide&&x.closeOnEsc){c(w);}}});i(document).on("click","."+s+"bg",function(){var w=p(),x={};if(w&&w.length){x=o(w,"options");
if(x.canHide&&x.closeOnBg){c(w);return false;}}});i(h).resize(function(){if(e){clearTimeout(e);e=0;}e=setTimeout(function(){r();},123);});function o(w,y,x){return x===j?w.data(s+y):w.data(s+y,x);
}function r(){var z=0,w=a.length,A=[],y=i(h).width(),x=i();for(;z<w;z++){x=x.add("#"+a[z]);A.push(a[z]);}z=0;x.each(function(){var B=i(b[A[z]]),D=i("#"+A[z]),C=o(B,"options"),E=isNaN(parseInt(C.width))?l.width:parseInt(C.width);
if(E+10>y){D.width(y);}else{D.width(E);}f(B);z++;});}function k(x,A,B){if(!x.length){return;}var O,y=o(x,"options"),C={},G=o(x,"hasInit"),I=o(x,"id"),E=i(h).width(),M=i(h).height(),N=i("#"+I),w=i("#"+I+"bg"),H=i("."+s+"title",N),z=i("."+s+"close",N),K=i("."+s+"body",N),F,L,J=0,D=isNaN(parseInt(A.width))?l.width:parseInt(A.width);
if(B!==j){K.html(B);}if(A.url){C.url="";F=i('<iframe src="'+A.url+'" style="width:100%;overflow:hidden;border:0;display:none;"></iframe>');x.html(F);L=i("<p style='font-size:20px;text-align: center;color: #888;'>加载中……</p>").appendTo(x);
F.load(function(){var P=400;L.remove();F.show();try{P=Math.max(F.contents().find("html").outerHeight(),F.contents().find("body").outerHeight());}catch(Q){}if(!P){P=400;
}F.height(P);f(x);});}if(A.title!==j){H.html(A.title);C.title=A.title;}if(A.width!==j){N.width(A.width);C.width=A.width;}if(D+10>E){N.width(E);}else{N.width(D);
}if(!m.test(A.height)){C.height=A.height;C.overflow=A.overflow||l.overflow;J=A.height=="100%"?M:parseInt(A.height);K.css({height:J-u,"overflow-y":C.overflow});
}if(A.zIndex&&A.zIndex>n){n=A.zIndex;w.css("z-index",n);N("z-index",++n);C.zIndex=n;}if(A.duration){C.duration=A.duration;}if(A.closeOnEsc!==j){C.closeOnEsc=A.closeOnEsc;
}if(A.closeOnBg!==j){C.closeOnBg=A.closeOnBg;}if(A.canHide===false){z.hide();C.canHide=false;}else{z.show();C.canHide=true;}if(A.onopen!==j){C.onopen=A.onopen;
}if(A.onclose!==j){C.onclose=A.onclose;}o(x,"options",i.extend({},y,C));}function t(x){if(!x.length){return;}var E,D=i(h).width(),z=i(h).height(),C=i(h).scrollLeft(),y=i(h).scrollTop(),A=x.width(),w=x.height(),F=(D-A)/2+C,B=(z-w)/3+y;
if(F<C){F=C+5;}if(B<y){B=y+5;}return{l:F,t:B,s:y,h:w};}function d(F,D){var C,w=o(F,"isOpen"),A=o(F,"hasInit"),E=o(F,"options"),x=o(F,"id"),y=i("#"+x),z=i("#"+x+"bg"),B=t(y);
if(!w&&A){y.css({left:B.l,top:B.s-B.h,display:"block"});z.css("z-index",++n).show().fadeTo(E.duration/2,0.5,function(){y.css("z-index",++n).animate({top:B.t},E.duration,function(){o(F,"isOpen",1);
a.push(x);E.onopen.call(y);if(D){D();}});});}}function f(w){var y,A=o(w,"isOpen"),z=o(w,"hasInit"),x=o(w,"options"),D=o(w,"id"),B=i("#"+D),C=t(B);if(A&&z){B.animate({left:C.l,top:C.t},x.duration/2);
}}function c(J,H){var G,w=o(J,"isOpen"),D=o(J,"hasInit"),I=o(J,"options"),y=o(J,"id"),A,B,F=i(h).width(),C=i(h).height(),z=i(h).scrollTop(),x=0,E=z-x;if(w&&D){A=i("#"+y);
B=i("#"+y+"bg");x=A.height();A.animate({top:E},I.duration,function(){i(this).hide();B.fadeOut(I.duration/2,function(){var K=i.inArray(y,a);J.data(s+"isOpen",0);
if(K!=-1){a.splice(K,1);}I.onclose.call(A);if(i.isFunction(H)){H();}});});}}function p(){return i(b[a[a.length-1]]);}})($,this);